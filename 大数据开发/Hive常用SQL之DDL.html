<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ovo.lol","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"disqus","storage":true,"lazyload":true,"nav":null,"activeClass":"disqus"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="忽略异常12345--如果不存在则创建表create table if not exists t_1(id int, firstname string, ...);--如果存在则删除表drop table if exists t_1;">
<meta property="og:type" content="article">
<meta property="og:title" content="Hive常用SQL之DDL">
<meta property="og:url" content="https://ovo.lol/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html">
<meta property="og:site_name" content="黑洞">
<meta property="og:description" content="忽略异常12345--如果不存在则创建表create table if not exists t_1(id int, firstname string, ...);--如果存在则删除表drop table if exists t_1;">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-04-06T04:58:00.000Z">
<meta property="article:modified_time" content="2022-04-11T04:45:50.518Z">
<meta property="article:author" content="Mr Fu">
<meta property="article:tag" content="Hive">
<meta property="article:tag" content="SQL">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://ovo.lol/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Hive常用SQL之DDL | 黑洞</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">黑洞</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">这里藏着一些独特的想法</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ovo.lol/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Mr Fu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="黑洞">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hive常用SQL之DDL
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-04-06 12:58:00" itemprop="dateCreated datePublished" datetime="2022-04-06T12:58:00+08:00">2022-04-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-11 12:45:50" itemprop="dateModified" datetime="2022-04-11T12:45:50+08:00">2022-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">大数据开发</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="大数据开发/Hive常用SQL之DDL.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="忽略异常"><a href="#忽略异常" class="headerlink" title="忽略异常"></a>忽略异常</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--如果不存在则创建表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> t_1(id <span class="type">int</span>, firstname string, ...);</span><br><span class="line"></span><br><span class="line"><span class="comment">--如果存在则删除表</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_1;</span><br></pre></td></tr></table></figure>

<span id="more"></span>
<h2 id="指定分隔符"><a href="#指定分隔符" class="headerlink" title="指定分隔符"></a>指定分隔符</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_hot_hero_skin_price(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    name string,</span><br><span class="line">    win_rate <span class="type">int</span>,</span><br><span class="line">    skin_price map<span class="operator">&lt;</span>string,<span class="type">int</span><span class="operator">&gt;</span></span><br><span class="line">)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span> <span class="comment">--字段之间分隔符</span></span><br><span class="line">collection items terminated <span class="keyword">by</span> <span class="string">&#x27;-&#x27;</span> <span class="comment">--集合元素之间分隔符</span></span><br><span class="line">map keys terminated <span class="keyword">by</span> <span class="string">&#x27;:&#x27;</span>; <span class="comment">--集合元素kv之间分隔符;</span></span><br></pre></td></tr></table></figure>

<p>如果没有指定字段之间的分隔符，Hive默认使用<code>\001</code>作为分隔符。</p>
<p>在清洗数据时应该尽量使用<code>\001</code>作为分隔符，避免与字段值的冲突，造成解析错误。</p>
<h2 id="json格式数据处理"><a href="#json格式数据处理" class="headerlink" title="json格式数据处理"></a>json格式数据处理</h2><p>在hive中，没有json类的存在，一般使用string类型来修饰，叫做json字符串。我们可以使用使用JsonSerDe类进行解析，在加载json数据到表中的时候完成解析动作。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 建表的时候直接使用JsonSerDe解析</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tb_json_test2 (</span><br><span class="line">    device string,</span><br><span class="line">    deviceType string,</span><br><span class="line">    signal <span class="keyword">double</span>,</span><br><span class="line">    `<span class="type">time</span>` string</span><br><span class="line">)</span><br><span class="line"><span class="type">ROW</span> FORMAT SERDE <span class="string">&#x27;org.apache.hive.hcatalog.data.JsonSerDe&#x27;</span></span><br><span class="line">STORED <span class="keyword">AS</span> TEXTFILE;</span><br><span class="line"></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/device.json&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> tb_json_test2;</span><br></pre></td></tr></table></figure>

<h2 id="外部表"><a href="#外部表" class="headerlink" title="外部表"></a>外部表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> t_1(id <span class="type">int</span>, firstname string, ...)</span><br></pre></td></tr></table></figure>

<p>当删除外部表时，只会删除表的元数据，实际文件将在HDFS上保留。</p>
<p>查看一个表是否为外部表可以通过以下命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> formatted t_1 <span class="comment">--查看元数据</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> t_1; <span class="comment">--或者查看建表语句</span></span><br><span class="line"></span><br><span class="line">MANAGED_TABLE   内部表 受控表</span><br><span class="line">EXTERNAL_TABLE  外部表</span><br></pre></td></tr></table></figure>

<h2 id="指定表数据路径"><a href="#指定表数据路径" class="headerlink" title="指定表数据路径"></a>指定表数据路径</h2><blockquote>
<p>存储路径由 hive.metastore.warehouse.dir 这个属性指定<br>默认值是：&#x2F;user&#x2F;hive&#x2F;warehouse</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--在建表的时候 可以使用location关键字指定表的路径在HDFS任意位置</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_team_ace_player_location(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    team_name string,</span><br><span class="line">    ace_player_name string)</span><br><span class="line">location <span class="string">&#x27;/data&#x27;</span>; <span class="comment">--使用location关键字指定本张表数据在hdfs上的存储路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--此时再上传数据 就必须上传到指定的目录下 否则就解析映射失败了</span></span><br></pre></td></tr></table></figure>

<p>在实际开发中，最好集中维护管理Hive表数据，避免文件在HDFS随意存放。</p>
<h2 id="分区表"><a href="#分区表" class="headerlink" title="分区表"></a>分区表</h2><ul>
<li><p>分区表是一种优化表，建表的时候可以不使用。但是当创建分区表之后，使用分区字段查询可以减少全表扫描，提高查询的效率。</p>
</li>
<li><p>企业中常用的分区字段</p>
<ul>
<li>地域维度：省，市</li>
<li>时间维度：day,month,year</li>
</ul>
</li>
</ul>
<h3 id="创建分区表"><a href="#创建分区表" class="headerlink" title="创建分区表"></a>创建分区表</h3><p>分区表的字段名不能与表的字段名重复！</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_all_hero_part(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    name string,</span><br><span class="line">    hp_max <span class="type">int</span>,</span><br><span class="line">    mp_max <span class="type">int</span>,</span><br><span class="line">    attack_max <span class="type">int</span>,</span><br><span class="line">    defense_max <span class="type">int</span>,</span><br><span class="line">    attack_range string,</span><br><span class="line">    role_main string,</span><br><span class="line">    role_assist string</span><br><span class="line">) partitioned <span class="keyword">by</span> (role string) <span class="comment">--这里以role_main这个字段分类</span></span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> &quot;\t&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="加载分区表"><a href="#加载分区表" class="headerlink" title="加载分区表"></a>加载分区表</h3><ul>
<li>静态加载（手动）</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--local 表示从本地文件系统加载，而非HDFS！</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/archer.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;sheshou&#x27;</span>);</span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/assassin.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;cike&#x27;</span>);</span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/mage.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;fashi&#x27;</span>);</span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/support.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;fuzhu&#x27;</span>);</span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/tank.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;tanke&#x27;</span>);</span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/warrior.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part <span class="keyword">partition</span>(role<span class="operator">=</span><span class="string">&#x27;zhanshi&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ul>
<li>动态加载</li>
</ul>
<p>当分类过多（比如：所有国家）时，一个个手动加载显然不现实，这时候就需要使用动态加载。</p>
<p>原理：查询全表并选择指定字段作为分区参考，插入到新建的分区表中。</p>
<p>首先设置允许动态分区、设置动态分区模式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--动态分区</span></span><br><span class="line"><span class="keyword">set</span> hive.exec.dynamic.partition<span class="operator">=</span><span class="literal">true</span>; <span class="comment">--注意hive3已经默认开启了</span></span><br><span class="line"><span class="keyword">set</span> hive.exec.dynamic.partition.mode<span class="operator">=</span>nonstrict;</span><br><span class="line"></span><br><span class="line">模式分为strict严格模式  nonstrict非严格模式</span><br><span class="line">严格模式要求 分区字段中至少有一个分区是静态分区。</span><br><span class="line"><span class="keyword">partition</span>(country<span class="operator">=</span>&quot;china&quot;,province) <span class="comment">--第一个分区写死了（静态） 符合严格模式。</span></span><br><span class="line"><span class="keyword">partition</span>(country,province)  <span class="comment">--两个分区都是动态确定的  需要非严格模式</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>查询返回的内容，其字段类型、顺序、个数要和待插入的表保持一致。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--创建一张新的分区表 t_all_hero_part_dynamic</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_all_hero_part_dynamic(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    name string,</span><br><span class="line">    hp_max <span class="type">int</span>,</span><br><span class="line">    mp_max <span class="type">int</span>,</span><br><span class="line">    attack_max <span class="type">int</span>,</span><br><span class="line">    defense_max <span class="type">int</span>,</span><br><span class="line">    attack_range string,</span><br><span class="line">    role_main string,</span><br><span class="line">    role_assist string</span><br><span class="line">) partitioned <span class="keyword">by</span> (role string)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> &quot;\t&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">--执行动态分区插入  --注意 分区值并没有手动写死指定</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> t_all_hero_part_dynamic <span class="keyword">partition</span>(role) </span><br><span class="line"><span class="keyword">select</span> tmp.<span class="operator">*</span>,tmp.role_main <span class="keyword">from</span> t_all_hero tmp;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询验证结果</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_all_hero_part_dynamic;</span><br></pre></td></tr></table></figure>

<h3 id="多重分区表"><a href="#多重分区表" class="headerlink" title="多重分区表"></a>多重分区表</h3><p>分区表也支持基于多个字段进行分区</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partitioned by(字段1 ，字段2....)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--以国家、省份 创建分区表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_user_double_p(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    name string,</span><br><span class="line">    country string</span><br><span class="line">) partitioned <span class="keyword">by</span>(guojia string,sheng string)</span><br><span class="line"><span class="type">row</span> format delimited</span><br><span class="line">fields terminated <span class="keyword">by</span> <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--加载数据到多分区表中</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/china_sh.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_user_double_p <span class="keyword">partition</span>(guojia<span class="operator">=</span>&quot;china&quot;,sheng<span class="operator">=</span>&quot;shanghai&quot;);</span><br><span class="line"></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/china_sz.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_user_double_p <span class="keyword">partition</span>(guojia<span class="operator">=</span>&quot;china&quot;,sheng<span class="operator">=</span>&quot;shenzhen&quot;);</span><br><span class="line"></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/usa_texas.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_user_double_p <span class="keyword">partition</span>(guojia<span class="operator">=</span>&quot;usa&quot;,sheng<span class="operator">=</span>&quot;texas&quot;);</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询来自于中国深圳的用户有哪些？</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_user_double_p <span class="keyword">where</span> guojia<span class="operator">=</span>&quot;china&quot;<span class="keyword">and</span> sheng<span class="operator">=</span>&quot;shenzhen&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="查看分区"><a href="#查看分区" class="headerlink" title="查看分区"></a>查看分区</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> partitions t_users;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查看分区下面的分区</span></span><br><span class="line"><span class="keyword">show</span> partitions t_china_gdp.province_partition;</span><br></pre></td></tr></table></figure>

<h3 id="添加、删除分区"><a href="#添加、删除分区" class="headerlink" title="添加、删除分区"></a>添加、删除分区</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--通过hive添加</span></span><br><span class="line">load data <span class="keyword">local</span> inpath <span class="string">&#x27;/root/hivedata/students.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> t_user_province <span class="keyword">partition</span>(province <span class="operator">=</span>&quot;SH&quot;);</span><br><span class="line"></span><br><span class="line"><span class="comment">--手动创建分区文件夹时绕开了hive，发现hive无法识别新分区，要添加分区元数据</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_user_province <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> (province<span class="operator">=</span><span class="string">&#x27;XM&#x27;</span>) location <span class="string">&#x27;/user/hive/warehouse/mydb.db/t_user_province/province=XM&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">----此外还支持一次添加多个分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;us&#x27;</span>) location <span class="string">&#x27;/path/to/us/part080808&#x27;</span> <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-09&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;us&#x27;</span>) location <span class="string">&#x27;/path/to/us/part080809&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--重命名分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> t_user_province <span class="keyword">PARTITION</span> (province <span class="operator">=</span>&quot;SH&quot;) RENAME <span class="keyword">TO</span> <span class="keyword">PARTITION</span> (province <span class="operator">=</span>&quot;Shanghai&quot;);</span><br><span class="line"></span><br><span class="line"><span class="comment">--删除分区</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> [IF <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;us&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--不经过回收站，直接删除数据</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> [IF <span class="keyword">EXISTS</span>] <span class="keyword">PARTITION</span> (dt<span class="operator">=</span><span class="string">&#x27;2008-08-08&#x27;</span>, country<span class="operator">=</span><span class="string">&#x27;us&#x27;</span>) PURGE;</span><br></pre></td></tr></table></figure>

<h2 id="分桶表"><a href="#分桶表" class="headerlink" title="分桶表"></a>分桶表</h2><p>分桶表也是一种优化表，可以提高join查询（减少笛卡尔积的数量）和抽样查询的效率。</p>
<p>分桶表的字段必须是表中已有的字段。</p>
<ul>
<li>原理：hashfunc(分桶字段)  %  N bucket  余数相同的来到同一个桶中</li>
</ul>
<ol>
<li>如果分桶的字段是数字类型的字段，hashfunc(分桶字段)&#x3D;分桶字段本身</li>
<li>如果分桶的字段是字符串或者其他字段，hashfunc(分桶字段) &#x3D; 分桶字段.hashcode</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CLUSTERED <span class="keyword">BY</span> xxx <span class="keyword">INTO</span> N BUCKETS</span><br><span class="line"><span class="comment">--根据xxx字段把数据分成N桶</span></span><br><span class="line"><span class="comment">--根据表中的字段把数据文件成为N个部分</span></span><br><span class="line"></span><br><span class="line">t_user(id <span class="type">int</span>,name string)</span><br><span class="line"><span class="comment">--1、根据谁分？</span></span><br><span class="line">CLUSTERED <span class="keyword">BY</span> xxx <span class="comment">--xxx必须是表中的字段</span></span><br><span class="line"><span class="comment">--2、分成几桶？</span></span><br><span class="line">N BUCKETS <span class="comment">--N的值就是分桶的个数</span></span><br><span class="line"><span class="comment">--3、分桶的规则？</span></span><br><span class="line">clustered <span class="keyword">by</span> id <span class="keyword">into</span> <span class="number">3</span> bucket</span><br><span class="line"></span><br><span class="line">hashfunc(分桶字段)  <span class="operator">%</span>  N bucket  余数相同的来到同一个桶中</span><br><span class="line"><span class="number">1</span>、如果分桶的字段是数字类型的字段，hashfunc(分桶字段)<span class="operator">=</span>分桶字段本身</span><br><span class="line"><span class="number">2</span>、如果分桶的字段是字符串或者其他字段，hashfunc(分桶字段) <span class="operator">=</span> 分桶字段.hashcode</span><br></pre></td></tr></table></figure>

<h3 id="创建分桶表"><a href="#创建分桶表" class="headerlink" title="创建分桶表"></a>创建分桶表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--根据state州分为5桶 每个桶内根据cases确诊病例数倒序排序</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_usa_covid19_bucket(</span><br><span class="line">    count_date string,</span><br><span class="line">    county string,</span><br><span class="line">    state string,</span><br><span class="line">    fips <span class="type">int</span>,</span><br><span class="line">    cases <span class="type">int</span>,</span><br><span class="line">    deaths <span class="type">int</span>)</span><br><span class="line">CLUSTERED <span class="keyword">BY</span>(state)</span><br><span class="line">sorted <span class="keyword">by</span> (cases <span class="keyword">desc</span>) <span class="keyword">INTO</span> <span class="number">5</span> BUCKETS;<span class="comment">--指定每个分桶内部根据 cases倒序排序</span></span><br></pre></td></tr></table></figure>

<h3 id="加载分桶表"><a href="#加载分桶表" class="headerlink" title="加载分桶表"></a>加载分桶表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--step1:开启分桶的功能 从Hive2.0开始不再需要设置</span></span><br><span class="line"><span class="keyword">set</span> hive.enforce.bucketing<span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">--step2:把源数据加载到普通hive表中</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_usa_covid19(</span><br><span class="line">    count_date string,</span><br><span class="line">    county string,</span><br><span class="line">    state string,</span><br><span class="line">    fips <span class="type">int</span>,</span><br><span class="line">    cases <span class="type">int</span>,</span><br><span class="line">    deaths <span class="type">int</span>)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> &quot;,&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">--将源数据上传到HDFS，t_usa_covid19表对应的路径下</span></span><br><span class="line">hadoop fs <span class="operator">-</span>put us<span class="operator">-</span>covid19<span class="operator">-</span>counties.dat <span class="operator">/</span><span class="keyword">user</span><span class="operator">/</span>hive<span class="operator">/</span>warehouse<span class="operator">/</span>covid19.db<span class="operator">/</span>t_usa_covid19</span><br><span class="line"></span><br><span class="line"><span class="comment">--step3:使用insert+select语法将数据加载到分桶表中</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_usa_covid19_bucket <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_usa_covid19;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_usa_covid19_bucket;</span><br></pre></td></tr></table></figure>

<h3 id="分桶表的使用"><a href="#分桶表的使用" class="headerlink" title="分桶表的使用"></a>分桶表的使用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--基于分桶字段state查询来自于New York的数据</span></span><br><span class="line"><span class="comment">--不再需要进行全表扫描过滤</span></span><br><span class="line"><span class="comment">--根据分桶的规则hash_function(New York) % 5计算出分桶编号</span></span><br><span class="line"><span class="comment">--查询指定分桶里面的数据 就可以找出结果  此时是分桶扫描而不是全表扫描</span></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_usa_covid19_bucket <span class="keyword">where</span> state<span class="operator">=</span>&quot;New York&quot;;</span><br></pre></td></tr></table></figure>

<h2 id="其他语句"><a href="#其他语句" class="headerlink" title="其他语句"></a>其他语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--描述数据库信息</span></span><br><span class="line"><span class="keyword">describe</span> database database_name;</span><br><span class="line"><span class="keyword">describe</span> database extended database_name;</span><br><span class="line"><span class="keyword">desc</span> database extended database_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询指定表的元数据信息</span></span><br><span class="line"><span class="keyword">desc</span> formatted database_name.table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--查询创建表的语句，用于复制、重建表。</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--更改表名</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name RENAME <span class="keyword">TO</span> new_table_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--当数据库没有表时</span></span><br><span class="line"><span class="keyword">DROP</span> DATABASE [IF <span class="keyword">EXISTS</span>] database_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">--当数据库下有表时，强制删除，慎用！</span></span><br><span class="line"><span class="keyword">DROP</span> DATABASE database_name CASCADE;</span><br><span class="line"></span><br><span class="line"><span class="comment">--显示当前支持的所有自定义和内置的函数</span></span><br><span class="line"><span class="keyword">show</span> functions;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    
        <div class="reward-container">
  <div>如果觉得文章写得不错或对您有帮助，请我喝杯柠檬茶吧！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.jpg" alt="Mr Fu 微信支付">
        <p>微信支付</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Mr Fu
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://ovo.lol/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html" title="Hive常用SQL之DDL">https://ovo.lol/大数据开发/Hive常用SQL之DDL.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Hive/" rel="tag"># Hive</a>
              <a href="/tags/SQL/" rel="tag"># SQL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/SQL%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" rel="prev" title="SQL学习笔记">
      <i class="fa fa-chevron-left"></i> SQL学习笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hadoop%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE.html" rel="next" title="Hadoop基础配置">
      Hadoop基础配置 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BF%BD%E7%95%A5%E5%BC%82%E5%B8%B8"><span class="nav-number">1.</span> <span class="nav-text">忽略异常</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E5%88%86%E9%9A%94%E7%AC%A6"><span class="nav-number">2.</span> <span class="nav-text">指定分隔符</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#json%E6%A0%BC%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86"><span class="nav-number">3.</span> <span class="nav-text">json格式数据处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E8%A1%A8"><span class="nav-number">4.</span> <span class="nav-text">外部表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E8%A1%A8%E6%95%B0%E6%8D%AE%E8%B7%AF%E5%BE%84"><span class="nav-number">5.</span> <span class="nav-text">指定表数据路径</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">6.</span> <span class="nav-text">分区表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">6.1.</span> <span class="nav-text">创建分区表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">6.2.</span> <span class="nav-text">加载分区表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%87%8D%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">6.3.</span> <span class="nav-text">多重分区表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%88%86%E5%8C%BA"><span class="nav-number">6.4.</span> <span class="nav-text">查看分区</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E3%80%81%E5%88%A0%E9%99%A4%E5%88%86%E5%8C%BA"><span class="nav-number">6.5.</span> <span class="nav-text">添加、删除分区</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%A1%B6%E8%A1%A8"><span class="nav-number">7.</span> <span class="nav-text">分桶表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%88%86%E6%A1%B6%E8%A1%A8"><span class="nav-number">7.1.</span> <span class="nav-text">创建分桶表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E5%88%86%E6%A1%B6%E8%A1%A8"><span class="nav-number">7.2.</span> <span class="nav-text">加载分桶表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%A1%B6%E8%A1%A8%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">7.3.</span> <span class="nav-text">分桶表的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E8%AF%AD%E5%8F%A5"><span class="nav-number">8.</span> <span class="nav-text">其他语句</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Mr Fu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">13</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      友情链接
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://blog.papwin.com/" title="https:&#x2F;&#x2F;blog.papwin.com&#x2F;" rel="noopener" target="_blank">潘岸平的獨立博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Mr Fu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  















    <div id="pjax">
  

  

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://ovolol.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://ovo.lol/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%BC%80%E5%8F%91/Hive%E5%B8%B8%E7%94%A8SQL%E4%B9%8BDDL.html";
    this.page.identifier = "大数据开发/Hive常用SQL之DDL.html";
    this.page.title = "Hive常用SQL之DDL";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://ovolol.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

    </div>
</body>
</html>
